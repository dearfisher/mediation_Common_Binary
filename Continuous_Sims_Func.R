#General necessary functions
mse <- function(sm){ mean(sm$residuals^2) }; erfinv <-  function(x) { qnorm((1 + x) /2) / sqrt(2) }; oddCalc<-function(p){ return((p/(1-p))) }

#For Proposed method
indirectEffectProposed <-function(s,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  return( oddCalc(pnorm(    (s*t0 + s*t1 + s*t4*c + s*t2*(b0 + b1 + b2*c)) / (sqrt(1 + (s*t2*sigma)^2))  )) / 
            oddCalc(pnorm(    (s*t0 + s*t1 + s*t4*c + s*t2*(b0 +      b2*c)) / (sqrt(1 + (s*t2*sigma)^2))  ))) }
directEffectProposed   <-function(s,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  return( oddCalc(pnorm(    (s*t0 + s*t1 + s*t4*c + s*t2*(b0 + b2*c)) / (sqrt(1 + (s*t2*sigma)^2))  )) /
            oddCalc(pnorm(    (s*t0 +        s*t4*c + s*t2*(b0 + b2*c)) / (sqrt(1 + (s*t2*sigma)^2))  ))) }

#For numerical approx
ie1Function<-function(med,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  return( inv.logit(t0 + t1 + t2*med + t4*c)*(1/sqrt(2*pi*sigma^2))*exp(-(med-(b0 + b1 + b2*c))^2 / (2*sigma^2)) ) }
ie2Function<-function(med,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  return( inv.logit(t0 + t1 + t2*med + t4*c)*(1/sqrt(2*pi*sigma^2))*exp(-(med-(b0 +      b2*c))^2 / (2*sigma^2)) ) }
de1Function<-function(med,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  return( inv.logit(t0 + t1 + t2*med + t4*c)*(1/sqrt(2*pi*sigma^2))*exp(-(med-(b0 +      b2*c))^2 / (2*sigma^2)) ) }
de2Function<-function(med,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  return( inv.logit(t0 +      t2*med + t4*c)*(1/sqrt(2*pi*sigma^2))*exp(-(med-(b0 +      b2*c))^2 / (2*sigma^2)) ) }

#For delta method
indirectDelta <-function(varLinModel,varLogitModel,s,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  sigmaMat <- matrix(0,nrow=8,ncol=8); sigmaMat[1:3,1:3] <- varLinModel 
  sigmaMat[4:7,4:7] <- varLogitModel; sigmaMat[8,8] <- sigma^2
  gammaVec <- matrix(0,nrow=1,ncol=8)
  gammaVec[1] <- (2^(1/2)*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2) - (2^(1/2)*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[2] <- (2^(1/2)*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[3] <- (2^(1/2)*c*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*c*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*c*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*c*s*t2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2)
  gammaVec[4] <- (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2)
  gammaVec[5] <- (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2)
  gammaVec[6] <- (exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*((2^(1/2)*s*(b0 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2) - (exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*((2^(1/2)*s*(b0 + b1 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2))))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*((2^(1/2)*s*(b0 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*((2^(1/2)*s*(b0 + b1 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[7] <- (2^(1/2)*c*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2) - (2^(1/2)*c*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*c*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*c*s*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[8] <- (2^(1/2)*s^2*sigma*t2^2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*s^2*sigma*t2^2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s^2*sigma*t2^2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s^2*sigma*t2^2*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b1 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2)
  return( sqrt(gammaVec %*% sigmaMat %*% t(gammaVec)) ) }
directDelta <-function(varLinModel,varLogitModel,s,t0,t1,t2,t4,c,sigma,b0,b1,b2){ 
  sigmaMat <- matrix(0,nrow=8,ncol=8); sigmaMat[1:3,1:3] <- varLinModel 
  sigmaMat[4:7,4:7] <- varLogitModel; sigmaMat[8,8] <- sigma^2
  gammaVec <- matrix(0,nrow=1,ncol=8)
  gammaVec[1] <- (2^(1/2)*s*t2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*t2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*t2*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*s*t2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2)
  gammaVec[2] <- 0
  gammaVec[3] <- (2^(1/2)*c*s*t2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2) - (2^(1/2)*c*s*t2*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*c*s*t2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*c*s*t2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[4] <- (2^(1/2)*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2) - (2^(1/2)*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[5] <- (2^(1/2)*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[6] <- (2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*((2^(1/2)*s*(b0 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2))))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*((2^(1/2)*s*(b0 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2))))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*((2^(1/2)*s*(b0 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2))))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*((2^(1/2)*s*(b0 + b2*c))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)) - (2^(1/2)*s^2*sigma^2*t2*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(3/2))))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2)
  gammaVec[7] <- (2^(1/2)*c*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2) - (2^(1/2)*c*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1))))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*c*s*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*c*s*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(1/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1))
  gammaVec[8] <- (2^(1/2)*s^2*sigma*t2^2*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) + (2^(1/2)*s^2*sigma*t2^2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s^2*sigma*t2^2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))^2*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)) - (2^(1/2)*s^2*sigma*t2^2*erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*exp(-(s*t0 + s*t2*(b0 + b2*c) + c*s*t4)^2/(2*(s^2*sigma^2*t2^2 + 1)))*(erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*pi^(1/2)*erfc((2^(1/2)*(s*t0 + s*t1 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))*(s^2*sigma^2*t2^2 + 1)^(3/2)*(erfc((2^(1/2)*(s*t0 + s*t2*(b0 + b2*c) + c*s*t4))/(2*(s^2*sigma^2*t2^2 + 1)^(1/2)))/2 - 1)^2)
  return( sqrt(gammaVec %*% sigmaMat %*% t(gammaVec)) ) }
  